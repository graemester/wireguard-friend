# WireGuard Test Container for wireguard-friend
# Alpine 3.19 with WireGuard tools, iptables, and Python

FROM alpine:3.19

# Install WireGuard and networking tools
RUN apk add --no-cache \
    wireguard-tools \
    iptables \
    ip6tables \
    iproute2 \
    python3 \
    py3-pip \
    bash \
    curl \
    bind-tools \
    libsodium \
    gcc \
    musl-dev \
    python3-dev \
    libffi-dev \
    && pip3 install --no-cache-dir --break-system-packages pynacl

# Enable IP forwarding
RUN echo "net.ipv4.ip_forward=1" >> /etc/sysctl.conf && \
    echo "net.ipv6.conf.all.forwarding=1" >> /etc/sysctl.conf

# Create WireGuard config directory
RUN mkdir -p /etc/wireguard

# Keep container running
CMD ["tail", "-f", "/dev/null"]
